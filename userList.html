<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <title>User-Manage</title>

    <link rel="stylesheet" type="text/css" href="./dist/semantic.css">

</head>
<body id="home">
<table class="ui celled striped table">
    <thead><tr><th colspan="4">用户列表</th></tr></thead>
    <tbody id="user-append"></tbody>
</table>
</body>
<script src="./js/jquery-3.4.1.min.js"></script>
<script src="./dist/semantic.js"></script>

<script>
    var requestBody = {
        "pageNum": 1,
        "pageSize": 10
    };
    var user_list = $('#user-append');

    $.ajax({
        type: "post",
        headers: {
            'Access-Token': localStorage.getItem("token")
        },
        url: "http://localhost:5050/apis/users/all",
        dataType: "json",
        contentType: "application/json",
        data: JSON.stringify(requestBody),
        success: function (jsonmsg) {
            if (jsonmsg.code == 200) {
                var users = jsonmsg.data;
                var ss = "";
                for (var id in users){
                    ss +=
                        '<tr>\n' +
                        '<td>' + users[id].userName + '</td>' +
                        '<td>' + users[id].birthday + '</td>' +
                        '<td class=\"right aligned collapsing\">' + (users[id].sex==null?"null":(users[id].sex==1?"男":"女")) + '</td>' +
                        '</tr>';
                }
                user_list.html(ss);
            }
        },
        error: function (jsonmsg) {
            console.log(jsonmsg);
            if (jsonmsg.responseJSON.code == 403){
                document.location.href = './403.html';
            }
            else if (jsonmsg.responseJSON.code == 401){
                document.location.href = './login.html';
            }
            else{
                alert(jsonmsg.responseJSON.msg);
            }
        }
    });
</script>
</html>
